<VirtualHost *:80>

    DocumentRoot "/var/www/html"

    AccessFileName .htaccess
    
    ErrorLog /var/log/apache2/error.log

     <IfModule mod_fastcgi.c>
        AddHandler php7-fcgi .php
        Action php7-fcgi /php7-fcgi virtual
        Alias /php7-fcgi /var/www/php7-fcgi
        FastCgiExternalServer /var/www/php7-fcgi -socket /var/run/php/php7.2-fpm.socket -pass-header Authorization -idle-timeout 3600
    </IfModule>

</VirtualHost>

<Directory "/var/www/html">
    Options -Indexes -MultiViews
    AllowOverride All
    Require all granted

    <IfModule mod_rewrite.c>
         RewriteEngine on
         RewriteOptions InheritBefore
         RewriteBase /
         RewriteCond %{REQUEST_URI} ^/php7-fcgi(.*)
         RewriteRule . - [L]
    </IfModule>

</Directory>

#prevent apache from serving .git directory
<Directorymatch "^/.*/\.git/">
    Order deny,allow
    Deny from all
</Directorymatch>